
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta property="og:title" content="ë‚˜ë§Œì˜ ëµê³¡ ë¦¬ìŠ¤íŠ¸"/>
    <meta property="og:description" content="ìˆ¨ê²¨ì§„ ëª…ê³¡ì„ ì‘ì„±í•´ ë³´ì!"/>
    <meta property="og:image" content="https://t1.daumcdn.net/cfile/tistory/257B004A583ABFE42E"/>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>

    <title>ë‚˜ë§Œì˜ ëµê³¡ ë¦¬ìŠ¤íŠ¸ | ê²Œì‹œíŒ</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sunflower:wght@300&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Sunflower', sans-serif;
        }

        .mypic {
            width: 100%;
            height: 200px;

            background-image: linear-gradient(0deg, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://t1.daumcdn.net/cfile/tistory/257B004A583ABFE42E');
            background-position: center 70%;
            background-size: contain;

            color: white;

            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .mypost {
            width: 70%;
            max-width: 500px;
            margin: 20px auto 20px auto;

            box-shadow: 0px 0px 3px 0px black;
            padding: 20px;
        }

        .mypost > button {
            margin-top: 15px;
        }

        .mycards {
            width: 95%;
            max-width: 500px;
            margin: auto;
        }

        .mycards > .card {
            margin-top: 10px;
            margin-bottom: 10px;
        }
        .blockquote-footer{
            display: flex;
            float: left;
        }
        .mybtn {
            width: 200px;
            height: 50px;

            background-color: transparent;
            color: white;

            border-radius: 50px;
            border: 1px solid white;

            margin-top: 10px;
        }
        .mybtn:hover {
            border: 2px solid white;
        }

        #modal {display: none; position: fixed; top: 0px; left: 0px; width: 100%; height: 100%;
            z-index: 2; background-color: rgba(0,0,0,0.5);}
        #modal .popup {position: absolute; left: 50%; top: 50%; margin: -175px 0 0 -300px; background: white; width:600px; height: 350px}
        #modal .popup button {float: right; margin-top: 30px; padding:5px 10px;}
        #modal

    </style>
    <script>
        function open_box() {
            $('#mypost').show()
        }

        function close_box() {
            $('#mypost').hide()
        }

        function isValidContents(content) {
            if (content == '') {
                alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return false;
            }
            if (content.trim().length > 140) {
                alert('ê³µë°± í¬í•¨ 140ì ì´í•˜ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return false;
            }
            return true;
        }

        $(document).ready(function () {
            getMessages();
            close_box();
        });

        // ë©”ëª¨ë¥¼ ë¶ˆëŸ¬ì™€ì„œ ë³´ì—¬ì£¼ê¸°
        function getMessages() {
            // 1. ê¸°ì¡´ ë©”ëª¨ ë‚´ìš©ì„ ì§€ìš°ê¸°
            // $('#review-list').empty();
            // 2. ë©”ëª¨ ëª©ë¡ì„ ë¶ˆëŸ¬ì™€ì„œ HTML ë¡œ ë¶™ì´ê¸°
            $.ajax({
                type: 'GET',
                url: '/api/blogs',
                success: function (response) {
                    for (let i=0; i<response.length; i++){
                        let contentList = response[i];
                        let id = contentList['id'];
                        let name = contentList['name'];
                        let title = contentList['title'];
                        let content = contentList['content'];
                        let modifiedAt = contentList['modifiedAt'];
                        addHTML(id, name, title, content, modifiedAt);
                    }
                }
            })
        }


        function addHTML(id, name, title, content, modifiedAt){
            let tempHtml = `<tr onclick="detail('${id}')">
                                <th class="id">${id}</th>
                                <td>${title}</td>
                                <td class="name">${name}</td>
                                <td class="modifiedAt">${modifiedAt}</td>
                            </tr>`
            $('#tableList').append(tempHtml);
        }

        function detail(id){
            window.location.href = `/api/blogs/detail?id=${id}`
        }


        function save_review() {
            let name = $('#name').val()
            let title = $('#title').val()
            let content = $('#content').val()
            if (isValidContents(content) == false) {
                return;
            }
            let data = {'name': name,'title': title,'content': content};
            $.ajax({
                type: 'POST',
                url: '/api/blogs',
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function (response) {
                    alert('ì €ì¥ ì„±ê³µ!');
                    window.location.reload();
                }
            })
        }

    </script>
</head>
<body>
<div class="mypic">
    <h1>ë‚˜ë§Œì˜ ëµê³¡ ë¦¬ìŠ¤íŠ¸</h1>
    <p>
        ë‚˜ì˜ í˜ì´ë³´ë¦¿ ìŒì•… ğŸ§ </br>
        í•¨ê»˜ ê³µìœ í• ë˜ìš”?
    </p>
    <button class="mybtn" onclick="open_box()">ê¸°ë¡í•˜ê¸°</button>
</div>
<div class="mypost" id="mypost">
    <div class="form-floating mb-3">
        <input name="artist" type="text" class="form-control" id="name" placeholder="url">
        <label for="floatingInput">ì‘ì„±ì</label>
    </div>
    <div class="form-floating mb-3">
        <input type="text" class="form-control" id="title" placeholder="url">
        <label for="floatingInput">ì œëª©</label>
    </div>
    <div class="form-floating">
            <textarea class="form-control" placeholder="Leave a comment here" id="content"
                      style="height: 100px"></textarea>
        <label for="floatingTextarea2">ë‚´ìš©</label>
    </div>
    <button onclick="save_review()" type="button" class="btn btn-dark">ë“±ë¡</button>
    <button onclick="close_box()" type="button" class="btn btn-dark">ë‹«ê¸°</button>
</div>

<div class="mycards" id="review-list">
    <table class="table" id="detailPopup">
        <thead>
        <tr class="tableHeader">
            <th class="id">ë²ˆí˜¸</th>
            <th>ì œëª©</th>
            <th class="name">ì‘ì„±ì</th>
            <th class="modifiedAt">ì‘ì„±ì¼ì</th>
        </tr>
        </thead>
        <tbody id = "tableList">
<!--        <tr>-->
<!--            <th class="id">1</th>-->
<!--            <td>ì œëª©ì…ë‹ˆë‹¤.</td>-->
<!--            <td class="name">ì‘ì„±ì</td>-->
<!--            <td class="modifiedAt">ì‘ì„±ì¼ì</td>-->
<!--        </tr>-->
<!--        <tr>-->
<!--            <th class="id">1</th>-->
<!--            <td>ì œëª©ì…ë‹ˆë‹¤.</td>-->
<!--            <td class="name">ì‘ì„±ì</td>-->
<!--            <td class="modifiedAt">ì‘ì„±ì¼ì</td>-->
<!--        </tr>-->
        </tbody>
    </table>
</div>


</body>
</html>